{
    "appid": "44a028fe-e612-4bed-8486-1e136ab5b5c2",
    "name": "Cisco SMA",
    "description": "App integration for Cisco SMA, Secure Email and Web Manager",
    "type": "information",
    "product_vendor": "Cisco",
    "logo": "logo_cisco.svg",
    "logo_dark": "logo_cisco_dark.svg",
    "product_name": "Cisco SMA",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "contributors": [
        {
            "name": "Gary Ian Rokas"
        }
    ],
    "license": "Copyright (c) 2024 Splunk Inc.",
    "app_version": "1.0.0",
    "latest_tested_versions": [
        "On-prem, Version 15.5.1, API v2.0 (/sma/api/v2.0), December 2024"
    ],
    "utctime_updated": "2024-12-10T00:00:00.000000Z",
    "package_name": "phantom_ciscosma",
    "main_module": "ciscosma_connector.py",
    "app_config_render": "default",
    "min_phantom_version": "6.3.0",
    "python_version": "3",
    "fips_compliant": true,
    "app_wizard_version": "1.0.0",
    "configuration": {
        "host": {
            "data_type": "string",
            "order": 0,
            "description": "Hostname or IP address of Cisco SMA",
            "required": true
        },
        "username": {
            "data_type": "string",
            "order": 1,
            "description": "Username for host",
            "required": true
        },
        "password": {
            "data_type": "password",
            "order": 2,
            "description": "Password for host",
            "required": true
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "identifier": "test_connectivity",
            "description": "Validate the asset configuration for connectivity using supplied configuration",
            "verbose": "",
            "type": "test",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "search quarantine messages",
            "identifier": "search_quarantine_messages",
            "description": "Search for messages in the spam quarantine",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "start_date": {
                    "description": "Start date in ISO format (YYYY-MM-DDThh:mm:ss.000Z)",
                    "data_type": "string",
                    "required": true,
                    "order": 0
                },
                "end_date": {
                    "description": "End date in ISO format (YYYY-MM-DDThh:mm:ss.000Z)",
                    "data_type": "string",
                    "required": true,
                    "order": 1
                },
                "order_by": {
                    "description": "Field to sort results by",
                    "data_type": "string",
                    "required": false,
                    "order": 2,
                    "value_list": ["from_address", "to_address", "subject"]
                },
                "order_direction": {
                    "description": "Sort direction",
                    "data_type": "string",
                    "required": false,
                    "order": 3,
                    "value_list": ["asc", "desc"]
                },
                "offset": {
                    "description": "Number of records to skip/offset",
                    "data_type": "numeric",
                    "required": false,
                    "order": 4
                },
                "limit": {
                    "description": "Max number of records to return",
                    "data_type": "numeric",
                    "required": false,
                    "order": 5
                },
                "envelope_recipient_filter_operator": {
                    "description": "Operator for envelope recipient filter",
                    "data_type": "string",
                    "required": false,
                    "order": 6,
                    "value_list": ["contains", "is", "begins_with", "ends_with", "does_not_contain"]
                },
                "envelope_recipient_filter_value": {
                    "description": "Value for envelope recipient filter",
                    "data_type": "string",
                    "required": false,
                    "order": 7
                },
                "filter_operator": {
                    "description": "Operator for general filter",
                    "data_type": "string",
                    "required": false,
                    "order": 8,
                    "value_list": ["contains", "is", "begins_with", "ends_with", "does_not_contain"]
                },
                "filter_value": {
                    "description": "Value for general filter",
                    "data_type": "string",
                    "required": false,
                    "order": 9
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.start_date",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.end_date",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.order_by",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.order_direction",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.offset",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.parameter.envelope_recipient_filter_operator",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.envelope_recipient_filter_value",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.filter_operator",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.filter_value",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.mid",
                    "data_type": "numeric",
                    "contains": ["cisco sma message id"]
                },
                {
                    "data_path": "action_result.data.*.attributes.subject",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.date",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.fromAddress",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attributes.toAddress",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attributes.envelopeRecipient",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attributes.size",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.total_messages",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.summary.messages_returned",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                }
            ],
            "versions": "EQ(*)"
        },
        {
            "action": "get message details",
            "identifier": "get_message_details",
            "description": "Retrieve details of a quarantined message",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "message_id": {
                    "description": "Message ID (mid) to retrieve details for",
                    "data_type": "string",
                    "required": true,
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.message_id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.mid",
                    "data_type": "numeric",
                    "contains": ["cisco sma message id"]
                },
                {
                    "data_path": "action_result.data.*.attributes.subject",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.date",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.fromAddress",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attributes.toAddress",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attributes.envelopeRecipient",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attributes.attachments",
                    "data_type": "string",
                    "contains": ["file_name"]
                },
                {
                    "data_path": "action_result.data.*.attributes.messageBody",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.subject",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                }
            ],
            "versions": "EQ(*)"
        },
        {
            "action": "release email",
            "identifier": "release_email",
            "description": "Release a quarantined email message",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "message_id": {
                    "description": "Message ID (mid) to release",
                    "data_type": "string",
                    "required": true,
                    "order": 0,
                    "contains": ["cisco sma message id"]
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.message_id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.action",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.totalCount",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.summary.total_released",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.summary.action",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                }
            ],
            "versions": "EQ(*)"
        },
        {
            "action": "delete email",
            "identifier": "delete_email",
            "description": "Delete a quarantined email message",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "message_id": {
                    "description": "Message ID (mid) to delete",
                    "data_type": "string",
                    "required": true,
                    "order": 0,
                    "contains": ["cisco sma message id"]
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.message_id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.action",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.totalCount",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.summary.total_deleted",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.summary.action",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                }
            ],
            "versions": "EQ(*)"
        },
        {
            "action": "search tracking messages",
            "identifier": "search_tracking_messages",
            "description": "Search for messages in message tracking",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "start_date": {
                    "description": "Start date in ISO format (YYYY-MM-DDThh:mm:ss.000Z)",
                    "data_type": "string",
                    "required": true,
                    "order": 0
                },
                "end_date": {
                    "description": "End date in ISO format (YYYY-MM-DDThh:mm:ss.000Z)",
                    "data_type": "string",
                    "required": true,
                    "order": 1
                },
                "cisco_host": {
                    "description": "Specific appliance to search (default: All_Hosts)",
                    "data_type": "string",
                    "required": false,
                    "order": 2
                },
                "offset": {
                    "description": "Number of records to skip/offset",
                    "data_type": "numeric",
                    "required": false,
                    "order": 3
                },
                "limit": {
                    "description": "Max number of records to return",
                    "data_type": "numeric",
                    "required": false,
                    "order": 4
                },
                "sender": {
                    "description": "Filter by sender email address",
                    "data_type": "string",
                    "required": false,
                    "order": 5
                },
                "recipient": {
                    "description": "Filter by recipient email address",
                    "data_type": "string",
                    "required": false,
                    "order": 6
                },
                "subject": {
                    "description": "Filter by message subject",
                    "data_type": "string",
                    "required": false,
                    "order": 7
                },
                "message_id": {
                    "description": "Filter by message ID (mid)",
                    "data_type": "string",
                    "required": false,
                    "order": 8
                },
                "status": {
                    "description": "Filter by message status",
                    "data_type": "string",
                    "required": false,
                    "order": 9,
                    "value_list": ["Delivered", "Hard Bounced", "Soft Bounced", "Spam", "Virus Positive", "Quarantined"]
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.start_date",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.end_date",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.cisco_host",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.offset",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.parameter.sender",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.recipient",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.subject",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.message_id",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.direction",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.icid",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.data.*.attributes.senderGroup",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.sender",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attributes.replyTo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.timestamp",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.hostName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.subject",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.mid",
                    "data_type": "numeric",
                    "contains": ["cisco sma message id"]
                },
                {
                    "data_path": "action_result.data.*.attributes.isCompleteData",
                    "data_type": "boolean"
                },
                {
                    "data_path": "action_result.data.*.attributes.messageStatus",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.mailPolicy",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.senderIp",
                    "data_type": "string",
                    "contains": ["ip"]
                },
                {
                    "data_path": "action_result.data.*.attributes.verdictChart",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.senderDomain",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.recipient",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attributes.sbrs",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attributes.serialNumber",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.total_messages",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.summary.messages_returned",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.summary.bad_records",
                    "data_type": "numeric"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                }
            ],
            "versions": "EQ(*)"
        },
        {
            "action": "get tracking details",
            "identifier": "get_message_tracking_details",
            "description": "Retrieve detailed tracking information for a message",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "mid": {
                    "description": "Message ID (mid) to retrieve details for",
                    "data_type": "string",
                    "required": true,
                    "order": 0
                },
                "icid": {
                    "description": "Incoming Connection ID",
                    "data_type": "string",
                    "required": false,
                    "order": 1
                },
                "serial_number": {
                    "description": "Appliance serial number",
                    "data_type": "string",
                    "required": false,
                    "order": 2
                },
                "start_date": {
                    "description": "Start date in ISO format (YYYY-MM-DDThh:mm:ss.000Z)",
                    "data_type": "string",
                    "required": false,
                    "order": 3
                },
                "end_date": {
                    "description": "End date in ISO format (YYYY-MM-DDThh:mm:ss.000Z)",
                    "data_type": "string",
                    "required": false,
                    "order": 4
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.mid",
                    "data_type": "string"                },
                {
                    "data_path": "action_result.parameter.icid",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.serial_number",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.start_date",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.parameter.end_date",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.mid",
                    "data_type": "numeric",
                    "contains": ["cisco sma message id"]
                },
                {
                    "data_path": "action_result.data.*.subject",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.messageStatus",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.direction",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sender",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.recipient",
                    "data_type": "string",
                    "contains": ["email"]
                },
                {
                    "data_path": "action_result.data.*.attachments",
                    "data_type": "string",
                    "contains": ["file_name"]
                },
                {
                    "data_path": "action_result.data.*.smtpAuthId",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.midHeader",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.timestamp",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.hostName",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sendingHostSummary.reverseDnsHostname",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sendingHostSummary.ipAddress",
                    "data_type": "string",
                    "contains": ["ip"]
                },
                {
                    "data_path": "action_result.data.*.sendingHostSummary.sbrsScore",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.summary.*.timestamp",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.summary.*.description",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.summary.*.lastEvent",
                    "data_type": "boolean"
                },
                {
                    "data_path": "action_result.data.*.messageSize",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.isCompleteData",
                    "data_type": "boolean"
                },
                {
                    "data_path": "action_result.data.*.showDLP",
                    "data_type": "boolean"
                },
                {
                    "data_path": "action_result.data.*.showAMP",
                    "data_type": "boolean"
                },
                {
                    "data_path": "action_result.data.*.showURL",
                    "data_type": "boolean"
                },
                {
                    "data_path": "action_result.data.*.showSummaryTimeBox",
                    "data_type": "boolean"
                },
                {
                    "data_path": "action_result.data.*.mailPolicy",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.senderGroup",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.subject",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.status",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.direction",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                }
            ],
            "versions": "EQ(*)"
        }
    ]
}
